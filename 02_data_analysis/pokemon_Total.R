>pokemon_data <- read.csv(file.choose(), stringsAsFactors = FALSE) //データセットの読み込み

>head(pokemon_data) //データの先頭部分の確認
  X.                  Name Type.1 Type.2
1  1             Bulbasaur  Grass Poison
2  2               Ivysaur  Grass Poison
3  3              Venusaur  Grass Poison
4  3 VenusaurMega Venusaur  Grass Poison
5  4            Charmander   Fire       
6  5            Charmeleon   Fire       
  Total HP Attack Defense Sp..Atk Sp..Def＞
1   318 45     49      49      65      65
2   405 60     62      63      80      80
3   525 80     82      83     100     100
4   625 80    100     123     122     120
5   309 39     52      43      60      50
6   405 58     64      58      80      65
  Speed Generation Legendary
1    45          1     False
2    60          1     False
3    80          1     False
4    80          1     False
5    65          1     False
6    80          1     False

> pokemon_data$Type.2[pokemon_data$Type.2 == ""] <- "None" //複合タイプがない場合はNoneにする

> Type_list <- c("Normal", "Fire", "Water", "Electric", "Grass", "Ice", "Fighting", 
"Poison", "Ground", "Flying", "Psychic", "Bug", "Rock", "Ghost", "Dragon", "Dark", 
"Steel", "Fairy","None") //タイプのリストを作成

> pokemon_data$Type.1 <- match(pokemon_data$Type.1,Type_list) //変数Type1をダミー化
> pokemon_data$Type.2 <- match(pokemon_data$Type.2,Type_list) //変数Type2をダミー化
> pokemon_data$Legendary <- as.factor(pokemon_data$Legendary) //変数Legendaryをダミー化

> head(pokemon_data) //正しく変換できているかの確認
  X.                  Name Type.1 Type.2
1  1             Bulbasaur      5      8
2  2               Ivysaur      5      8
3  3              Venusaur      5      8
4  3 VenusaurMega Venusaur      5      8
5  4            Charmander      2     19
6  5            Charmeleon      2     19
  Total HP Attack Defense Sp..Atk Sp..Def
1   318 45     49      49      65      65
2   405 60     62      63      80      80
3   525 80     82      83     100     100
4   625 80    100     123     122     120
5   309 39     52      43      60      50
6   405 58     64      58      80      65
  Speed Generation Legendary
1    45          1     False
2    60          1     False
3    80          1     False
4    80          1     False
5    65          1     False
6    80          1     False

> pokemon_lm <- lm(Total~ Type.1 + Type.2 + Legendary + Generation, data = pokemon_data) //回帰分析
> summary(pokemon_lm) //結果の表示

Call:
lm(formula = Total ~ Type.1 + Type.2 + Legendary + Generation, 
    data = pokemon_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-240.792  -86.846    6.535   77.680  283.059 

Coefficients:
               Estimate Std. Error t value
(Intercept)   447.99471   14.17560  31.603
Type.1          0.60441    0.71472   0.846
Type.2         -2.42848    0.68745  -3.533
LegendaryTrue 215.94525   13.49395  16.003
Generation     -0.02767    2.23399  -0.012
              Pr(>|t|)    
(Intercept)    < 2e-16 ***
Type.1        0.397993    
Type.2        0.000435 ***
LegendaryTrue  < 2e-16 ***
Generation    0.990121    
---
Signif. codes:  
  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1
  ‘ ’ 1

Residual standard error: 103.1 on 795 degrees of freedom
Multiple R-squared:  0.265,	Adjusted R-squared:  0.2614 
F-statistic: 71.68 on 4 and 795 DF,  p-value: < 2.2e-16

>predict(pokemon_lm,pokemon_data) //モデルによる予測結果
       1        2        3        4        5 
431.5612 431.5612 431.5612 431.5612 403.0347 
       6        7        8        9       10 
403.0347 424.8910 412.7486 424.8910 403.6391 
      11       12       13       14       15 
403.6391 403.6391 403.6391 409.0788 409.0788 
      16       17       18       19       20 
430.9352 435.7921 435.7921 435.7921 435.7921 
      21       22       23       24       25 
424.2866 424.2866 424.2866 424.2866 402.4303 
      26       27       28       29       30 
402.4303 424.2866 424.2866 406.6612 406.6612 
      31       32       33       34       35 
404.2435 404.2435 407.2656 407.2656 406.6612 
      36       37       38       39       40 
406.6612 430.9460 406.6612 406.6612 430.9460 
      41       42       43       44       45 
412.7053 412.7053 403.0347 403.0347 404.8587 
      46       47       48       49       50 
404.8587 428.5175 428.5175 431.5612 431.5612 
      51       52       53       54       55 
431.5612 443.0776 443.0776 435.7921 435.7921 
      56       57       58       59       60 
407.2656 407.2656 402.4303 402.4303 403.6391 
      61       62       63       64       65 
403.6391 406.0567 406.0567 403.0347 403.0347 
      66       67       68       69       70 
403.6391 403.6391 432.7809 408.4744 408.4744 
      71       72       73       74       75 
408.4744 408.4744 406.0567 406.0567 406.0567 
      76       77       78       79       80 
431.5612 431.5612 431.5612 430.3524 430.3524 
      81       82       83       84       85 
433.9681 433.9681 433.9681 403.0347 403.0347 
      86       87       88       89       90 
423.0670 423.0670 423.0670 409.1005 409.1005 
      91       92       93       94       95 
424.2866 424.2866 424.2866 403.6391 435.2094 
      96       97       98       99      100 
406.6612 406.6612 403.6391 435.2094 437.0010 
     101      102      103      104      105 
437.0010 437.0010 437.0010 433.9681 408.4744 
     106      107      108      109      110 
408.4744 403.6391 403.6391 404.2435 404.2435 
     111      112      113      114      115 
424.2758 424.2758 407.2656 407.2656 406.0567 
     116      117      118      119      120 
406.0567 402.4303 406.6612 406.6612 421.8365 
     121      122      123      124      125 
421.8365 402.4303 404.8479 402.4303 402.4303 
     126      127      128      129      130 
403.6391 403.6391 403.6391 403.6391 403.6391 
     131      132      133      134      135 
423.0670 410.9029 430.9352 424.8802 404.2435 
     136      137      138      139      140 
403.0347 409.0788 430.9352 402.4303 403.6391 
     141      142      143      144      145 
425.4954 410.9245 435.2094 402.4303 402.4303 
     146      147      148      149      150 
403.6391 404.2435 403.0347 402.4303 448.5390 
     151      152      153      154      155 
448.5390 448.5390 448.5390 431.5396 431.5396 
     156      157      158      159      160 
402.4303 643.2539 642.0451 640.8363 410.8921 
     161      162      163      164      165 
410.8921 432.7484 624.4196 653.5615 624.4196 
     166      167      168      169      170 
408.4744 404.8202 404.8202 404.8202 403.0070 
     171      172      173      174      175 
403.0070 403.0070 403.6114 403.6114 403.6114 
     176      177      178      179      180 
402.4026 402.4026 424.2589 424.2589 430.9075 
     181      182      183      184      185 
430.9075 435.7645 435.7645 428.4898 440.0387 
     186      187      188      189      190 
440.0387 404.2158 412.6776 404.8311 412.6776 
     191      192      193      194      195 
434.5340 430.3031 430.3031 404.2158 404.2158 
     196      197      198      199      200 
404.2158 413.9298 404.8202 406.0399 406.0399 
     201      202      203      204      205 
409.6556 403.6114 426.6766 426.6766 426.6766 
     206      207      208      209      210 
402.4026 404.8202 404.8202 430.9075 427.8963 
     211      212      213      214      215 
427.8963 408.4467 411.4688 433.3252 423.0393 
     216      217      218      219      220 
410.2600 408.4467 408.4467 421.8305 409.0511 
     221      222      223      224      225 
413.9081 402.4026 429.0943 436.3581 436.3581 
     226      227      228      229      230 
412.6776 412.6776 430.3247 413.9081 413.9081 
     231      232      233      234      235 
423.6220 438.1930 438.1930 443.0391 402.4026 
     236      237      238      239      240 
402.4026 403.0070 417.5779 429.7095 429.7095 
     241      242      243      244      245 
418.1823 403.6114 403.6114 427.2810 425.4678 
     246      247      248      249      250 
433.9296 452.7530 452.7530 452.7530 413.3254 
     251      252      253      254      255 
407.2379 407.2379 402.4026 402.4026 402.4026 
     256      257      258      259      260 
406.0291 406.0291 424.8525 404.2158 403.0070 
     261      262      263      264      265 
402.4026 402.4026 620.1611 618.9522 619.5567 
     266      267      268      269      270 
433.9404 433.9404 416.9410 416.9410 646.2483 
     271      272      273      274      275 
640.8086 442.4455 404.7926 404.7926 404.7926 
     276      277      278      279      280 
414.5065 402.9793 432.1211 432.1211 432.1211 
     281      282      283      284      285 
403.5837 427.8686 427.8686 427.8686 411.4411 
     286      287      288      289      290 
411.4411 402.3749 402.3749 409.0235 409.0235 
     291      292      293      294      295 
430.8798 409.0235 435.7368 437.5825 437.5825 
     296      297      298      299      300 
437.5825 404.7926 412.0780 412.0780 424.2313 
     301      302      303      304      305 
424.2313 425.4401 425.4401 410.8475 410.8475 
     306      307      308      309      310 
410.8475 410.8475 447.8792 430.8798 404.7926 
     311      312      313      314      315 
433.9344 402.3749 402.3749 402.3749 433.3083 
     316      317      318      319      320 
430.8798 421.1659 402.3749 402.3749 402.3749 
     321      322      323      324      325 
406.0014 406.0014 404.8034 409.6279 402.3749 
     326      327      328      329      330 
402.3749 423.5836 423.5836 414.4740 414.4740 
     331      332      333      334      335 
426.6165 426.6165 426.6165 412.0455 425.4293 
     336      337      338      339      340 
425.4293 425.4293 404.1882 404.1882 404.1882 
     341      342      343      344      345 
404.1882 404.1882 409.0235 409.0235 431.5059 
     346      347      348      349      350 
406.6058 406.6058 410.8692 410.8692 410.8692 
     351      352      353      354      355 
403.5837 403.5837 427.2642 427.2642 427.2642 
     356      357      358      359      360 
402.9793 408.4191 408.4191 402.3749 407.2102 
     361      362      363      364      365 
416.9242 416.9242 404.7926 412.0780 424.2313 
     366      367      368      369      370 
432.6931 413.2652 402.3749 406.6058 429.0558 
     371      372      373      374      375 
429.0558 427.8686 427.8686 403.5837 410.8692 
     376      377      378      379      380 
426.6381 426.6381 443.6267 443.6267 426.6273 
     381      382      383      384      385 
426.6273 403.5837 403.5837 402.3749 402.3749 
     386      387      388      389      390 
410.2323 410.2323 410.2323 410.2323 410.2323 
     391      392      393      394      395 
426.6489 408.4191 411.4411 411.4411 408.4191 
     396      397      398      399      400 
405.3970 405.3970 405.3970 444.2527 444.2527 
     401      402      403      404      405 
444.2527 403.5837 403.5837 403.5837 418.1547 
     406      407      408      409      410 
403.5837 410.8367 410.8367 432.6931 432.6931 
     411      412      413      414      415 
431.4734 431.4734 431.4734 431.4734 625.5731 
     416      417      418      419      420 
621.3422 627.9908 646.2098 646.2098 646.2098 
     421      422      423      424      425 
646.2098 619.5290 619.5290 623.1555 664.4397 
     426      427      428      429      430 
648.6383 648.6383 647.4187 624.3643 624.3643 
     431      432      433      434      435 
624.3643 624.3643 404.7649 404.7649 429.0497 
     436      437      438      439      440 
402.9517 432.0935 432.0935 403.5561 403.5561 
     441      442      443      444      445 
408.4130 424.2036 424.2036 424.2036 402.3472 
     446      447      448      449      450 
441.2030 408.9958 408.9958 404.1605 404.1605 
     451      452      453      454      455 
404.1605 431.4782 431.4782 409.6002 409.6002 
     456      457      458      459      460 
414.4572 414.4572 408.9958 442.9946 433.2806 
     461      462      463      464      465 
413.8528 430.8522 430.8522 430.8522 404.1605 
     466      467      468      469      470 
403.5561 403.5561 404.7649 404.7649 403.5561 
     471      472      473      474      475 
427.8409 402.3472 432.0610 432.0610 402.3472 
     476      477      478      479      480 
402.3472 431.4891 410.2046 433.2698 402.3472 
     481      482      483      484      485 
402.3472 408.3914 413.8636 413.8636 431.4458 
     486      487      488      489      490 
431.4458 409.6002 410.8199 402.3472 424.2036 
     491      492      493      494      495 
417.4901 435.0939 435.0939 435.0939 435.0939 
     496      497      498      499      500 
402.3472 405.9737 410.8307 410.8307 407.1826 
     501      502      503      504      505 
407.1826 423.5775 413.8636 435.7200 435.7200 
     506      507      508      509      510 
404.7649 403.5561 403.5561 425.4124 436.3352 
     511      512      513      514      515 
436.3352 436.3352 442.9838 409.0175 402.3472 
     516      517      518      519      520 
421.7535 404.7649 404.1605 402.9517 434.4786 
     521      522      523      524      525 
430.8522 404.7649 405.3693 429.0389 429.6542 
     526      527      528      529      530 
402.3472 437.5332 437.5332 414.4572 410.2046 
     531      532      533      534      535 
417.5117 416.3029 445.4447 443.0162 435.7308 
     536      537      538      539      540 
426.0169 438.1593 624.3366 624.3366 624.3366 
     541      542      543      544      545 
637.6771 629.2153 623.7539 618.2925 635.8638 
     546      547      548      549      550 
635.8638 408.3914 403.5561 403.5561 627.3587 
     551      552      553      554      555 
620.7102 642.5665 618.2925 665.5932 404.7372 
     556      557      558      559      560 
404.7372 404.7372 402.9240 432.0658 432.0658 
     561      562      563      564      565 
403.5284 403.5284 403.5284 402.3196 402.3196 
     566      567      568      569      570 
402.3196 402.3196 402.3196 411.3858 411.3858 
     571      572      573      574      575 
404.7372 404.7372 402.9240 402.9240 403.5284 
     576      577      578      579      580 
403.5284 408.3637 408.3637 424.1759 424.1759 
     581      582      583      584      585 
424.1759 404.1328 404.1328 409.5725 409.5725 
     586      587      588      589      590 
409.5725 430.2201 430.2201 407.1549 412.0119 
     591      592      593      594      595 
402.3196 404.7481 405.9461 405.9461 405.9461 
     596      597      598      599      600 
403.5284 427.8133 427.8133 405.9461 405.9461 
     601      602      603      604      605 
442.9669 442.9669 442.9669 435.6815 435.6815 
     606      607      608      609      610 
435.6815 407.1657 407.1657 404.7372 404.7372 
     611      612      613      614      615 
403.5284 414.4403 414.4403 414.4403 402.9240 
     616      617      618      619      620 
402.9240 422.3519 404.7372 423.5390 423.5390 
     621      622      623      624      625 
440.5276 440.5276 430.2201 410.1770 410.1770 
     626      627      628      629      630 
418.0993 418.0993 431.4289 431.4289 406.5505 
     631      632      633      634      635 
406.5505 411.3858 411.3858 402.3196 402.3196 
     636      637      638      639      640 
408.3637 408.3637 408.3637 408.3637 408.3637 
     641      642      643      644      645 
408.3637 425.3848 425.3848 405.3417 405.3417 
     646      647      648      649      650 
405.3417 436.3184 436.3184 425.9892 408.9681 
     651      652      653      654      655 
413.8251 431.4506 431.4506 415.6708 415.6708 
     656      657      658      659      660 
403.5284 445.3954 445.3954 409.5942 409.5942 
     661      662      663      664      665 
411.9902 411.9902 411.9902 404.1328 404.1328 
     666      667      668      669      670 
404.1328 408.3637 408.3637 451.4612 451.4612 
     671      672      673      674      675 
451.4612 410.7814 410.7814 410.7814 405.3417 
     676      677      678      679      680 
405.3417 405.3417 408.9681 408.9681 443.5822 
     681      682      683      684      685 
405.9461 405.9461 410.7814 419.2973 419.2973 
     686      687      688      689      690 
416.2428 416.2428 402.3196 424.1759 424.1759 
     691      692      693      694      695 
433.2422 433.2422 402.9240 413.8251 421.0997 
     696      697      698      699      700 
421.0997 421.0997 450.2524 450.2524 657.0773 
     701      702      703      704      705 
654.6596 649.8243 623.7046 623.7046 641.9344 
     706      707      708      709      710 
641.9344 668.0109 663.1539 644.9565 644.9565 
     711      712      713      714      715 
658.2969 658.2969 658.2969 432.6702 432.6702 
     716      717      718      719      720 
421.7475 431.4614 413.8251 404.7096 404.7096 
     721      722      723      724      725 
433.8514 402.8963 402.8963 422.3242 403.5007 
     726      727      728      729      730 
403.5007 410.7862 402.2919 426.5768 424.1483 
     731      732      733      734      735 
424.7527 424.7527 408.9405 408.9405 430.7968 
     736      737      738      739      740 
446.6090 446.6090 412.5670 412.5670 412.5670 
     741      742      743      744      745 
404.7096 404.7096 405.9184 413.2038 402.2919 
     746      747      748      749      750 
408.3361 408.3361 408.3361 424.1050 424.1050 
     751      752      753      754      755 
424.1050 424.1050 412.5670 412.5670 412.5670 
     756      757      758      759      760 
412.5670 430.7860 430.7860 448.4006 448.4006 
     761      762      763      764      765 
445.3786 416.2367 403.5007 403.5007 447.8179 
     766      767      768      769      770 
447.8179 419.2588 419.2588 441.1152 441.1152 
     771      772      773      774      775 
412.5670 427.7748 406.5336 411.9734 410.7537 
     776      777      778      779      780 
410.7537 410.7537 414.3910 444.1481 444.1481 
     781      782      783      784      785 
444.1481 444.1481 444.1481 444.1481 444.1481 
     786      787      788      789      790 
444.1481 444.1481 444.1481 405.3140 405.3140 
     791      792      793      794      795 
417.4456 417.4456 628.5122 649.1597 650.9838 
     796      797      798      799      800 
627.9186 627.9186 636.4237 631.5668 657.6973 

> predict <- predict(pokemon_lm, pokemon_data) //グラフ作成のための変数
> residual <- residuals(pokemon_lm) //グラフ作成のための変数

> plot(pokemon_data$Total, predict, xlab="measure", ylab="predict") //散布図の作成
> abline(a=0, b=1, col="red") //基準となる直線

> qqnorm(residual) //QQプロットの作成
> qqline(residual,col="red") //基準となる直線